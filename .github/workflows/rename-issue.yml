name: Rename Issue Title with Prefix

on:
  issues:
    types:
      - opened  # Trigger the workflow when a new issue is created

jobs:
  rename-issue:
    runs-on: ubuntu-latest

    steps:
    - name: Rename issue with prefix
      env:
        # The repository name where the workflow is running
        REPO_NAME: ${{ github.repository }}
        # The issue number generated by GitHub
        ISSUE_NUMBER: ${{ github.event.issue.number }}
        # The original title of the issue as provided by the user
        ORIGINAL_TITLE: ${{ github.event.issue.title }}
        # The project name to use as a prefix for the issue
        PROJECT_NAME: WeatherProject  # Update this to match your project name
      run: |
        # Get the issue number from the GitHub event and create the new title
        NUMBER=$ISSUE_NUMBER
        NEW_TITLE="${PROJECT_NAME}-${NUMBER}: ${ORIGINAL_TITLE}"

        # Use the GitHub API to update the issue title
        curl -X PATCH \
          -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \ # Authenticate using the GITHUB_TOKEN provided by GitHub Actions
          -H "Content-Type: application/json" \ # Specify JSON content type
          -d "{\"title\":\"${NEW_TITLE}\"}" \ # Payload to update the title
          "https://api.github.com/repos/${REPO_NAME}/issues/${NUMBER}" # API endpoint for the specific issue
